- tag = @repository.find_tag(release.tag)
- commit = @repository.commit(tag.dereferenced_target)
%li.flex-row
  .row-main-content.str-truncated
    %span.item-title.ref-name.prepend-left-4
      = release.tag

    - if protected_tag?(@project, tag)
      %span.badge.badge-success.prepend-left-4
        = s_('TagsPage|protected')

    - if commit
      .block-truncated
        .branch-commit
          .icon-container.commit-icon
            = custom_icon("icon_commit")
          = link_to commit.short_id, project_commit_path(@project, commit.id), class: "commit-sha"
          &middot;
          %span.str-truncated
            = icon('tag')
            = link_to tag.name, project_tag_path(@project, tag.name), class: 'ref-name prepend-left-4'
          &middot;
          #{time_ago_with_tooltip(commit.committed_date)}
    - else
      %p
        = s_("TagsPage|Can't find HEAD commit for this tag")
    - if release.description.present?
      .description.prepend-top-default
        .wiki
          = markdown_field(release, :description)

  .row-fixed-content.controls.flex-row
    -# = render 'projects/buttons/download', project: @project, ref: tag.name, pipeline: @tags_pipelines[tag.name]

    - if can?(current_user, :push_code, @project)
      = link_to edit_project_tag_release_path(@project, tag.name), class: 'btn has-tooltip', title: s_('TagsPage|Edit release notes'), data: { container: "body" } do
        = icon("pencil")

      -# if can?(current_user, :admin_project, @project)
        = link_to project_tag_path(@project, tag.name), class: "btn btn-remove remove-row has-tooltip prepend-left-10 #{protected_tag?(@project, tag) ? 'disabled' : ''}", title: s_('TagsPage|Delete tag'), method: :delete, data: { confirm: s_('TagsPage|Deleting the %{tag_name} tag cannot be undone. Are you sure?') % { tag_name: tag.name }, container: 'body' }, remote: true do
          = icon("trash-o")
